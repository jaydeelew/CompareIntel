============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0 -- /home/dan_wsl/jaydeelew/CompareIntel/backend/venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/dan_wsl/jaydeelew/CompareIntel/backend
configfile: pyproject.toml
plugins: asyncio-1.3.0, mock-3.15.1, anyio-3.7.1, cov-7.0.0, timeout-2.4.0, Faker-39.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
timeout: 300.0s
timeout method: thread
timeout func_only: False
collecting ... collected 147 items

tests/unit/test_auth.py::TestUserRegistration::test_register_new_user FAILED [  0%]
tests/unit/test_auth.py::TestUserRegistration::test_register_duplicate_email ERROR [  1%]
tests/unit/test_auth.py::TestUserRegistration::test_register_invalid_email PASSED [  2%]
tests/unit/test_auth.py::TestUserRegistration::test_register_weak_password PASSED [  2%]
tests/unit/test_auth.py::TestUserLogin::test_login_success ERROR         [  3%]
tests/unit/test_auth.py::TestUserLogin::test_login_wrong_password ERROR  [  4%]
tests/unit/test_auth.py::TestUserLogin::test_login_nonexistent_user PASSED [  4%]
tests/unit/test_auth.py::TestUserLogin::test_login_unverified_user PASSED [  5%]
tests/unit/test_auth.py::TestTokenRefresh::test_refresh_token_success ERROR [  6%]
tests/unit/test_auth.py::TestTokenRefresh::test_refresh_token_unauthorized FAILED [  6%]
tests/unit/test_auth.py::TestEmailVerification::test_verify_email_success PASSED [  7%]
tests/unit/test_auth.py::TestEmailVerification::test_verify_email_invalid_token PASSED [  8%]
tests/unit/test_auth.py::TestEmailVerification::test_verify_email_expired_token PASSED [  8%]
tests/unit/test_auth.py::TestEmailVerification::test_resend_verification_email FAILED [  9%]
tests/unit/test_auth.py::TestEmailVerification::test_resend_verification_already_verified ERROR [ 10%]
tests/unit/test_auth.py::TestEmailVerification::test_resend_verification_nonexistent_email PASSED [ 10%]
tests/unit/test_auth.py::TestPasswordReset::test_forgot_password_success ERROR [ 11%]
tests/unit/test_auth.py::TestPasswordReset::test_forgot_password_nonexistent_email PASSED [ 12%]
tests/unit/test_auth.py::TestPasswordReset::test_reset_password_success PASSED [ 12%]
tests/unit/test_auth.py::TestPasswordReset::test_reset_password_invalid_token PASSED [ 13%]
tests/unit/test_auth.py::TestPasswordReset::test_reset_password_expired_token PASSED [ 14%]
tests/unit/test_auth.py::TestUserInfo::test_get_current_user_info ERROR  [ 14%]
tests/unit/test_auth.py::TestUserInfo::test_get_current_user_info_unauthorized PASSED [ 15%]
tests/unit/test_auth.py::TestUserInfo::test_logout ERROR                 [ 16%]
tests/unit/test_auth.py::TestUserInfo::test_delete_account FAILED        [ 17%]
tests/unit/test_auth.py::TestUserInfo::test_delete_account_unverified FAILED [ 17%]
tests/unit/test_auth.py::TestLoginEdgeCases::test_login_inactive_user FAILED [ 18%]
tests/unit/test_auth.py::TestLoginEdgeCases::test_login_case_sensitive_email ERROR [ 19%]
tests/unit/test_auth.py::TestLoginEdgeCases::test_refresh_token_with_inactive_user FAILED [ 19%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_expired_access_token FAILED [ 20%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_expired_refresh_token FAILED [ 21%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_malformed_token PASSED [ 21%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_without_bearer_prefix PASSED [ 22%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_access_token_as_refresh_token ERROR [ 23%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_refresh_token_as_access_token ERROR [ 23%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_with_invalid_user_id PASSED [ 24%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_without_sub_claim PASSED [ 25%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_with_non_numeric_sub PASSED [ 25%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_empty_token PASSED [ 26%]
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_after_user_deletion FAILED [ 27%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_minimum_length PASSED [ 27%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_too_short PASSED [ 28%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_no_digit PASSED [ 29%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_no_uppercase PASSED [ 29%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_no_lowercase PASSED [ 30%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_no_special_char PASSED [ 31%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_all_requirements PASSED [ 31%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_unicode_characters PASSED [ 32%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_very_long PASSED [ 33%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_empty_string PASSED [ 34%]
tests/unit/test_auth_edge_cases.py::TestPasswordValidationEdgeCases::test_password_strength_only_special_chars PASSED [ 34%]
tests/unit/test_auth_edge_cases.py::TestPasswordHashingEdgeCases::test_hash_and_verify_same_password PASSED [ 35%]
tests/unit/test_auth_edge_cases.py::TestPasswordHashingEdgeCases::test_verify_wrong_password PASSED [ 36%]
tests/unit/test_auth_edge_cases.py::TestPasswordHashingEdgeCases::test_verify_empty_password PASSED [ 36%]
tests/unit/test_auth_edge_cases.py::TestPasswordHashingEdgeCases::test_hash_empty_password PASSED [ 37%]
tests/unit/test_auth_edge_cases.py::TestVerificationTokenEdgeCases::test_verification_token_uniqueness PASSED [ 38%]
tests/unit/test_auth_edge_cases.py::TestVerificationTokenEdgeCases::test_verification_token_length PASSED [ 38%]
tests/unit/test_auth_edge_cases.py::TestVerificationTokenEdgeCases::test_verification_token_url_safe PASSED [ 39%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_login_with_empty_email PASSED [ 40%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_login_with_empty_password ERROR [ 40%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_empty_fields PASSED [ 41%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_very_long_email PASSED [ 42%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_sql_injection_attempt PASSED [ 42%]
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_xss_attempt PASSED [ 43%]
tests/unit/test_model_runner.py::TestModelRunnerMockMode::test_call_openrouter_streaming_mock_mode PASSED [ 44%]
tests/unit/test_model_runner_edge_cases.py::TestStreamingErrorHandling::test_streaming_connection_error PASSED [ 44%]
tests/unit/test_model_runner_edge_cases.py::TestStreamingErrorHandling::test_streaming_timeout_error PASSED [ 45%]
tests/unit/test_model_runner_edge_cases.py::TestStreamingErrorHandling::test_streaming_empty_response PASSED [ 46%]
tests/unit/test_model_runner_edge_cases.py::TestCleanModelResponse::test_clean_normal_response PASSED [ 46%]
tests/unit/test_model_runner_edge_cases.py::TestCleanModelResponse::test_clean_response_with_whitespace PASSED [ 47%]
tests/unit/test_model_runner_edge_cases.py::TestCleanModelResponse::test_clean_empty_response PASSED [ 48%]
tests/unit/test_model_runner_edge_cases.py::TestCleanModelResponse::test_clean_error_response PASSED [ 48%]
tests/unit/test_model_runner_edge_cases.py::TestCleanModelResponse::test_clean_response_with_special_chars PASSED [ 49%]
tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_free_tier_credits ERROR [ 50%]
tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_premium_tier_credits ERROR [ 51%]
tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_credits_exceeded ERROR [ 51%]
tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_deduct_user_credits ERROR [ 52%]
tests/unit/test_rate_limiting.py::TestAnonymousCreditLimiting::test_anonymous_credit_check PASSED [ 53%]
tests/unit/test_rate_limiting.py::TestAnonymousCreditLimiting::test_anonymous_credits_exceeded PASSED [ 53%]
tests/unit/test_rate_limiting.py::TestAnonymousCreditLimiting::test_deduct_anonymous_credits PASSED [ 54%]
tests/unit/test_rate_limiting.py::TestCreditLimitEdgeCases::test_credits_with_nonexistent_user PASSED [ 55%]
tests/unit/test_rate_limiting.py::TestCreditLimitEdgeCases::test_credits_with_invalid_tier ERROR [ 55%]
tests/unit/test_rate_limiting.py::TestCreditLimitEdgeCases::test_concurrent_credit_checks ERROR [ 56%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_free_tier_credits ERROR [ 57%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_tier_credits ERROR [ 57%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_plus_tier_credits ERROR [ 58%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_tier_credits ERROR [ 59%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_plus_tier_credits ERROR [ 59%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_free_tier_exceeds_credits ERROR [ 60%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_tier_exceeds_credits ERROR [ 61%]
tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_tier_exceeds_credits ERROR [ 61%]
tests/unit/test_rate_limiting.py::TestUsageStats::test_user_usage_stats ERROR [ 62%]
tests/unit/test_rate_limiting.py::TestUsageStats::test_anonymous_usage_stats PASSED [ 63%]
tests/unit/test_rate_limiting.py::TestAnonymousCreditEdgeCases::test_anonymous_multiple_identifiers PASSED [ 63%]
tests/unit/test_rate_limiting.py::TestAnonymousCreditEdgeCases::test_anonymous_credits_reset_on_new_day PASSED [ 64%]
tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_at_exact_limit ERROR [ 65%]
tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_one_below_limit ERROR [ 65%]
tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_one_above_limit ERROR [ 66%]
tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_zero_usage ERROR [ 67%]
tests/unit/test_rate_limiting_edge_cases.py::TestCreditReset::test_reset_on_new_day ERROR [ 68%]
tests/unit/test_rate_limiting_edge_cases.py::TestCreditReset::test_no_reset_same_day ERROR [ 68%]
tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_by_one ERROR [ 69%]
tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_by_multiple ERROR [ 70%]
tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_zero ERROR [ 70%]
tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_more_than_allocated ERROR [ 71%]
tests/unit/test_rate_limiting_edge_cases.py::TestAnonymousCreditBoundaries::test_anonymous_at_limit PASSED [ 72%]
tests/unit/test_rate_limiting_edge_cases.py::TestAnonymousCreditBoundaries::test_anonymous_one_below_limit FAILED [ 72%]
tests/unit/test_rate_limiting_edge_cases.py::TestAnonymousCreditBoundaries::test_anonymous_reset_on_new_day PASSED [ 73%]
tests/unit/test_rate_limiting_edge_cases.py::TestUsageStats::test_usage_stats_at_limit ERROR [ 74%]
tests/unit/test_rate_limiting_edge_cases.py::TestUsageStats::test_usage_stats_zero_usage ERROR [ 74%]
tests/unit/test_rate_limiting_edge_cases.py::TestUsageStats::test_anonymous_usage_stats PASSED [ 75%]
tests/unit/test_rate_limiting_edge_cases.py::TestConcurrentAccess::test_concurrent_deduction ERROR [ 76%]
tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_free_tier_credits ERROR [ 76%]
tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_starter_tier_credits ERROR [ 77%]
tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_pro_tier_credits ERROR [ 78%]
tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_pro_plus_tier_credits ERROR [ 78%]
tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_tier_hierarchy PASSED [ 79%]
tests/unit/test_search_providers.py::TestSearchResult::test_search_result_creation PASSED [ 80%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_provider_initialization FAILED [ 80%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_get_provider_name PASSED [ 81%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_is_available_with_api_key PASSED [ 82%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_is_available_without_api_key PASSED [ 82%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_success FAILED [ 83%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_with_custom_max_results FAILED [ 84%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_api_error PASSED [ 85%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_network_error PASSED [ 85%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_empty_results FAILED [ 86%]
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_missing_fields FAILED [ 87%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_available_providers PASSED [ 87%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_available_providers_none PASSED [ 88%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_provider_brave PASSED [ 89%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_provider_no_api_key PASSED [ 89%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_provider_unknown PASSED [ 90%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_active_provider PASSED [ 91%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_active_provider_none_configured PASSED [ 91%]
tests/unit/test_search_providers.py::TestSearchProviderFactory::test_get_active_provider_no_settings PASSED [ 92%]
tests/unit/test_utils.py::TestDateUtilities::test_date_formatting PASSED [ 93%]
tests/unit/test_utils.py::TestDateUtilities::test_time_delta_calculations PASSED [ 93%]
tests/unit/test_utils.py::TestValidationUtilities::test_email_validation PASSED [ 94%]
tests/unit/test_utils.py::TestValidationUtilities::test_password_validation PASSED [ 95%]
tests/unit/test_utils.py::TestFormattingUtilities::test_number_formatting PASSED [ 95%]
tests/unit/test_utils.py::TestFormattingUtilities::test_string_formatting PASSED [ 96%]
tests/unit/test_utils.py::TestHashUtilities::test_password_hashing PASSED [ 97%]
tests/unit/test_utils.py::TestHashUtilities::test_fingerprint_hashing PASSED [ 97%]
tests/unit/test_utils.py::TestErrorHandling::test_error_formatting PASSED [ 98%]
tests/unit/test_utils.py::TestErrorHandling::test_exception_handling PASSED [ 99%]
tests/unit/test_utils.py::TestConstants::test_extended_tier_limits_exist FAILED [100%]

==================================== ERRORS ====================================
_____ ERROR at setup of TestUserRegistration.test_register_duplicate_email _____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:01 - app.main - INFO - Validating configuration...
2026-01-04 11:32:01 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:01 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:01 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:01 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:01 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:01 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:01 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:01 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:01 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:01 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:01 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:01 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:01 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:01 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:01 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:01 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:01 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:01 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:01 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:01 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:01 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:01 - app.main - INFO - Database initialization complete
2026-01-04 11:32:01 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:01 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:01 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:01 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:01 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:01 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:01 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:01 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
______________ ERROR at setup of TestUserLogin.test_login_success ______________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:02 - app.main - INFO - Validating configuration...
2026-01-04 11:32:02 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:02 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:02 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:02 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:02 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:02 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:02 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:02 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:02 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:02 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:02 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:02 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:02 - app.main - INFO - Database initialization complete
2026-01-04 11:32:02 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:02 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:02 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:02 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:02 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:02 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:02 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:02 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
__________ ERROR at setup of TestUserLogin.test_login_wrong_password ___________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:02 - app.main - INFO - Validating configuration...
2026-01-04 11:32:02 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:02 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:02 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:02 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:02 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:02 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:02 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:02 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:02 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:02 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:02 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:02 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:02 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:02 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:02 - app.main - INFO - Database initialization complete
2026-01-04 11:32:02 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:02 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:03 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:03 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:03 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:03 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:03 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:03 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
________ ERROR at setup of TestTokenRefresh.test_refresh_token_success _________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:04 - app.main - INFO - Validating configuration...
2026-01-04 11:32:04 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:04 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:04 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:04 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:04 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:04 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:04 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:04 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:04 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:04 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:04 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:04 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:04 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:04 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:04 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:04 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:04 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:04 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:04 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:04 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:04 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:04 - app.main - INFO - Database initialization complete
2026-01-04 11:32:04 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:04 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:04 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:04 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:04 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:04 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:04 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:04 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_ ERROR at setup of TestEmailVerification.test_resend_verification_already_verified _
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:07 - app.main - INFO - Validating configuration...
2026-01-04 11:32:07 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:07 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:07 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:07 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:07 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:07 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:07 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:07 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:07 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:07 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:07 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:07 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:07 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:07 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:07 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:07 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:07 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:07 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:07 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:07 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:07 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:07 - app.main - INFO - Database initialization complete
2026-01-04 11:32:07 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:07 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:07 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:07 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:07 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:07 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:07 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:07 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_______ ERROR at setup of TestPasswordReset.test_forgot_password_success _______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:08 - app.main - INFO - Validating configuration...
2026-01-04 11:32:08 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:08 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:08 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:08 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:08 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:08 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:08 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:08 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:08 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:08 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:08 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:08 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:08 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:08 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:08 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:08 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:08 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:08 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:08 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:08 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:08 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:08 - app.main - INFO - Database initialization complete
2026-01-04 11:32:08 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:08 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:08 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:08 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:08 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:08 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:08 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:08 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
__________ ERROR at setup of TestUserInfo.test_get_current_user_info ___________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:10 - app.main - INFO - Validating configuration...
2026-01-04 11:32:10 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:10 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:10 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:10 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:10 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:10 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:10 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:10 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:10 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:10 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:10 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:10 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:10 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:10 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:10 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:10 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:10 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:10 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:10 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:10 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:10 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:10 - app.main - INFO - Database initialization complete
2026-01-04 11:32:10 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:10 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:10 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:10 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:10 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:10 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:10 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:10 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
__________________ ERROR at setup of TestUserInfo.test_logout __________________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:11 - app.main - INFO - Validating configuration...
2026-01-04 11:32:11 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:11 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:11 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:11 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:11 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:11 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:11 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:11 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:11 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:11 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:11 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:11 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:11 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:11 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:11 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:11 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:11 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:11 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:11 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:11 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:11 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:11 - app.main - INFO - Database initialization complete
2026-01-04 11:32:11 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:11 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:11 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:11 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:11 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:11 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:11 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:11 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_____ ERROR at setup of TestLoginEdgeCases.test_login_case_sensitive_email _____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:14 - app.main - INFO - Validating configuration...
2026-01-04 11:32:14 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:14 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:14 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:14 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:14 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:14 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:14 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:14 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:14 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:14 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:14 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:14 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:14 - app.main - INFO - Database initialization complete
2026-01-04 11:32:14 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:14 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:14 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:14 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:14 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:14 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:14 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:14 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
___ ERROR at setup of TestTokenEdgeCases.test_access_token_as_refresh_token ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:17 - app.main - INFO - Validating configuration...
2026-01-04 11:32:17 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:17 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:17 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:17 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:17 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:17 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:17 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:17 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:17 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:17 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:17 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:17 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:17 - app.main - INFO - Database initialization complete
2026-01-04 11:32:17 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:17 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:17 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:17 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:17 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:17 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:17 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:17 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
___ ERROR at setup of TestTokenEdgeCases.test_refresh_token_as_access_token ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:17 - app.main - INFO - Validating configuration...
2026-01-04 11:32:17 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:17 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:17 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:17 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:17 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:17 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:17 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:17 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:17 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:17 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:17 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:17 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:17 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:17 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:17 - app.main - INFO - Database initialization complete
2026-01-04 11:32:17 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:17 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:18 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:18 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:18 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:18 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:18 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:18 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
______ ERROR at setup of TestAuthEdgeCases.test_login_with_empty_password ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:23 - app.main - INFO - Validating configuration...
2026-01-04 11:32:23 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:23 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:23 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:23 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:23 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:23 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:23 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:23 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:23 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:23 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:23 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:23 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:23 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:23 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:23 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:23 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:23 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:23 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:23 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:23 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:23 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:23 - app.main - INFO - Database initialization complete
2026-01-04 11:32:23 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:23 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:23 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:23 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:23 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:23 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:23 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:23 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_______ ERROR at setup of TestUserCreditLimiting.test_free_tier_credits ________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
______ ERROR at setup of TestUserCreditLimiting.test_premium_tier_credits ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:195: in test_user_premium
    return create_pro_user(
tests/factories.py:141: in create_pro_user
    return create_user(db, subscription_tier="pro", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
________ ERROR at setup of TestUserCreditLimiting.test_credits_exceeded ________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
______ ERROR at setup of TestUserCreditLimiting.test_deduct_user_credits _______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
__ ERROR at setup of TestCreditLimitEdgeCases.test_credits_with_invalid_tier ___
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___ ERROR at setup of TestCreditLimitEdgeCases.test_concurrent_credit_checks ___
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_________ ERROR at setup of TestAllTierCredits.test_free_tier_credits __________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
________ ERROR at setup of TestAllTierCredits.test_starter_tier_credits ________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:166: in test_user_starter
    return create_starter_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:131: in create_starter_user
    return create_user(db, subscription_tier="starter", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_____ ERROR at setup of TestAllTierCredits.test_starter_plus_tier_credits ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:172: in test_user_starter_plus
    return create_starter_plus_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:136: in create_starter_plus_user
    return create_user(db, subscription_tier="starter_plus", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
__________ ERROR at setup of TestAllTierCredits.test_pro_tier_credits __________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:178: in test_user_pro
    return create_pro_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:141: in create_pro_user
    return create_user(db, subscription_tier="pro", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_______ ERROR at setup of TestAllTierCredits.test_pro_plus_tier_credits ________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:184: in test_user_pro_plus
    return create_pro_plus_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:146: in create_pro_plus_user
    return create_user(db, subscription_tier="pro_plus", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_____ ERROR at setup of TestAllTierCredits.test_free_tier_exceeds_credits ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
____ ERROR at setup of TestAllTierCredits.test_starter_tier_exceeds_credits ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:166: in test_user_starter
    return create_starter_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:131: in create_starter_user
    return create_user(db, subscription_tier="starter", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
______ ERROR at setup of TestAllTierCredits.test_pro_tier_exceeds_credits ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:178: in test_user_pro
    return create_pro_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:141: in create_pro_user
    return create_user(db, subscription_tier="pro", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
____________ ERROR at setup of TestUsageStats.test_user_usage_stats ____________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:150: in test_user
    return create_free_user(
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
____ ERROR at setup of TestUserCreditBoundaries.test_credits_at_exact_limit ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___ ERROR at setup of TestUserCreditBoundaries.test_credits_one_below_limit ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___ ERROR at setup of TestUserCreditBoundaries.test_credits_one_above_limit ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
______ ERROR at setup of TestUserCreditBoundaries.test_credits_zero_usage ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___________ ERROR at setup of TestCreditReset.test_reset_on_new_day ____________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___________ ERROR at setup of TestCreditReset.test_no_reset_same_day ___________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
____________ ERROR at setup of TestDeductCredits.test_deduct_by_one ____________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_________ ERROR at setup of TestDeductCredits.test_deduct_by_multiple __________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_____________ ERROR at setup of TestDeductCredits.test_deduct_zero _____________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_____ ERROR at setup of TestDeductCredits.test_deduct_more_than_allocated ______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
__________ ERROR at setup of TestUsageStats.test_usage_stats_at_limit __________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_________ ERROR at setup of TestUsageStats.test_usage_stats_zero_usage _________
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_______ ERROR at setup of TestConcurrentAccess.test_concurrent_deduction _______
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
___ ERROR at setup of TestDifferentSubscriptionTiers.test_free_tier_credits ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:160: in test_user_free
    return create_free_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:126: in create_free_user
    return create_user(db, subscription_tier="free", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
__ ERROR at setup of TestDifferentSubscriptionTiers.test_starter_tier_credits __
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:166: in test_user_starter
    return create_starter_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:131: in create_starter_user
    return create_user(db, subscription_tier="starter", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
____ ERROR at setup of TestDifferentSubscriptionTiers.test_pro_tier_credits ____
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:178: in test_user_pro
    return create_pro_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:141: in create_pro_user
    return create_user(db, subscription_tier="pro", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
_ ERROR at setup of TestDifferentSubscriptionTiers.test_pro_plus_tier_credits __
venv/lib/python3.12/site-packages/pytest_asyncio/plugin.py:730: in pytest_fixture_setup
    return (yield)
            ^^^^^
tests/conftest.py:184: in test_user_pro_plus
    return create_pro_plus_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:146: in create_pro_plus_user
    return create_user(db, subscription_tier="pro_plus", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
=================================== FAILURES ===================================
_________________ TestUserRegistration.test_register_new_user __________________
tests/unit/test_auth.py:28: in test_register_new_user
    assert response.status_code == status.HTTP_201_CREATED
E   assert 400 == 201
E    +  where 400 = <Response [400 Bad Request]>.status_code
E    +  and   201 = status.HTTP_201_CREATED
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:00 - app.main - INFO - Validating configuration...
2026-01-04 11:32:00 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:00 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:00 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:00 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:00 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:00 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:00 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:00 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:00 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:00 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:00 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:00 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:00 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:00 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:00 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:00 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:00 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:00 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:00 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:00 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:00 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:00 - app.main - INFO - Database initialization complete
2026-01-04 11:32:00 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:00 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:00 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:00 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:00 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:00 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:00 - app.search.distributed_rate_limiter - INFO -  Redis client created - will test connection on first use
2026-01-04 11:32:00 - app.search.rate_limiter - INFO -  Initialized DISTRIBUTED search rate limiter with Redis: 3 req/min, 2 concurrent, 3.0s delay. Cache: enabled. Circuit breaker: enabled.
2026-01-04 11:32:00 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:00 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.search.distributed_rate_limiter:distributed_rate_limiter.py:431  Redis client created - will test connection on first use
INFO     app.search.rate_limiter:rate_limiter.py:335  Initialized DISTRIBUTED search rate limiter with Redis: 3 req/min, 2 concurrent, 3.0s delay. Cache: enabled. Circuit breaker: enabled.
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:00 - app.routers.auth - WARNING - reCAPTCHA verification failed: token not provided (reCAPTCHA is configured)
2026-01-04 11:32:00 - httpx - INFO - HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
------------------------------ Captured log call -------------------------------
WARNING  app.routers.auth:auth.py:118 reCAPTCHA verification failed: token not provided (reCAPTCHA is configured)
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/register "HTTP/1.1 400 Bad Request"
_______________ TestTokenRefresh.test_refresh_token_unauthorized _______________
tests/unit/test_auth.py:169: in test_refresh_token_unauthorized
    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY
E   assert 401 == 422
E    +  where 401 = <Response [401 Unauthorized]>.status_code
E    +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:05 - app.main - INFO - Validating configuration...
2026-01-04 11:32:05 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:05 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:05 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:05 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:05 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:05 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:05 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:05 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:05 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:05 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:05 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:05 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:05 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:05 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:05 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:05 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:05 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:05 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:05 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:05 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:05 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:05 - app.main - INFO - Database initialization complete
2026-01-04 11:32:05 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:05 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:05 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:05 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:05 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:05 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:05 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:05 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:05 - httpx - INFO - HTTP Request: POST http://testserver/api/auth/refresh "HTTP/1.1 401 Unauthorized"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/api/auth/refresh "HTTP/1.1 401 Unauthorized"
_____________ TestEmailVerification.test_resend_verification_email _____________
tests/unit/test_auth.py:252: in test_resend_verification_email
    user = create_unverified_user(db_session, email="resend@example.com")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:177: in create_unverified_user
    return create_user(db, is_verified=False, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:06 - app.main - INFO - Validating configuration...
2026-01-04 11:32:06 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:06 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:06 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:06 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:06 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:06 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:06 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:06 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:06 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:06 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:06 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:06 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:06 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:06 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:06 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:06 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:06 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:06 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:06 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:06 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:06 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:06 - app.main - INFO - Database initialization complete
2026-01-04 11:32:06 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:06 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:06 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:06 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:06 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:06 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:06 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:06 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_______________________ TestUserInfo.test_delete_account _______________________
tests/unit/test_auth.py:411: in test_delete_account
    user = create_user(db_session, email="delete@example.com", is_verified=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:12 - app.main - INFO - Validating configuration...
2026-01-04 11:32:12 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:12 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:12 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:12 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:12 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:12 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:12 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:12 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:12 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:12 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:12 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:12 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:12 - app.main - INFO - Database initialization complete
2026-01-04 11:32:12 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:12 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:12 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:12 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:12 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:12 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:12 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:12 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_________________ TestUserInfo.test_delete_account_unverified __________________
tests/unit/test_auth.py:437: in test_delete_account_unverified
    user = create_unverified_user(db_session, email="unverified_delete@example.com")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:177: in create_unverified_user
    return create_user(db, is_verified=False, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:12 - app.main - INFO - Validating configuration...
2026-01-04 11:32:12 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:12 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:12 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:12 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:12 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:12 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:12 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:12 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:12 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:12 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:12 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:12 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:12 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:12 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:12 - app.main - INFO - Database initialization complete
2026-01-04 11:32:12 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:12 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:13 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:13 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:13 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:13 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:13 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:13 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_________________ TestLoginEdgeCases.test_login_inactive_user __________________
tests/unit/test_auth.py:464: in test_login_inactive_user
    user = create_inactive_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:182: in create_inactive_user
    return create_user(db, is_active=False, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:13 - app.main - INFO - Validating configuration...
2026-01-04 11:32:13 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:13 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:13 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:13 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:13 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:13 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:13 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:13 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:13 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:13 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:13 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:13 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:13 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:13 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:13 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:13 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:13 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:13 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:13 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:13 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:13 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:13 - app.main - INFO - Database initialization complete
2026-01-04 11:32:13 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:13 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:13 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:13 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:13 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:13 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:13 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:13 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
___________ TestLoginEdgeCases.test_refresh_token_with_inactive_user ___________
tests/unit/test_auth.py:492: in test_refresh_token_with_inactive_user
    user = create_user(db_session, email="inactive_refresh@example.com")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:14 - app.main - INFO - Validating configuration...
2026-01-04 11:32:14 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:14 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:14 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:14 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:14 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:14 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:14 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:14 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:14 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:14 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:14 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:14 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:14 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:14 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:14 - app.main - INFO - Database initialization complete
2026-01-04 11:32:14 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:14 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:15 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:15 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:15 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:15 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:15 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:15 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_________________ TestTokenEdgeCases.test_expired_access_token _________________
tests/unit/test_auth_edge_cases.py:33: in test_expired_access_token
    user = create_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:15 - app.main - INFO - Validating configuration...
2026-01-04 11:32:15 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:15 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:15 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:15 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:15 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:15 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:15 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:15 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:15 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:15 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:15 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:15 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:15 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:15 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:15 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:15 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:15 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:15 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:15 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:15 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:15 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:15 - app.main - INFO - Database initialization complete
2026-01-04 11:32:15 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:15 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:15 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:15 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:15 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:15 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:15 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:15 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
________________ TestTokenEdgeCases.test_expired_refresh_token _________________
tests/unit/test_auth_edge_cases.py:50: in test_expired_refresh_token
    user = create_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:16 - app.main - INFO - Validating configuration...
2026-01-04 11:32:16 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:16 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:16 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:16 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:16 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:16 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:16 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:16 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:16 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:16 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:16 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:16 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:16 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:16 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:16 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:16 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:16 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:16 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:16 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:16 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:16 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:16 - app.main - INFO - Database initialization complete
2026-01-04 11:32:16 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:16 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:16 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:16 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:16 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:16 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:16 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:16 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
______________ TestTokenEdgeCases.test_token_after_user_deletion _______________
tests/unit/test_auth_edge_cases.py:141: in test_token_after_user_deletion
    user = create_user(db_session)
           ^^^^^^^^^^^^^^^^^^^^^^^
tests/factories.py:95: in create_user
    user = User(
<string>:4: in __init__
    ???
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:596: in _initialize_instance
    with util.safe_reraise():
venv/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py:224: in __exit__
    raise exc_value.with_traceback(exc_tb)
venv/lib/python3.12/site-packages/sqlalchemy/orm/state.py:594: in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
venv/lib/python3.12/site-packages/sqlalchemy/orm/decl_base.py:2179: in _declarative_constructor
    raise TypeError(
E   TypeError: 'daily_usage_count' is an invalid keyword argument for User
---------------------------- Captured stderr setup -----------------------------
2026-01-04 11:32:19 - app.main - INFO - Validating configuration...
2026-01-04 11:32:19 - app.config.validation - INFO - Configuration validation passed successfully
2026-01-04 11:32:19 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:19 - app.config.validation - INFO - Application Configuration
2026-01-04 11:32:19 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:19 - app.config.validation - INFO - Environment: development
2026-01-04 11:32:19 - app.config.validation - INFO - Frontend URL: http://localhost:5173
2026-01-04 11:32:19 - app.config.validation - INFO - Database URL: sqlite:///./data/compareintel.db
2026-01-04 11:32:19 - app.config.validation - INFO - Secret Key: test...hars
2026-01-04 11:32:19 - app.config.validation - INFO - OpenRouter API Key: test...only
2026-01-04 11:32:19 - app.config.validation - INFO - Email Configuration: (not configured)
2026-01-04 11:32:19 - app.config.validation - INFO - Performance Settings:
2026-01-04 11:32:19 - app.config.validation - INFO -   Individual Model Timeout: 120s
2026-01-04 11:32:19 - app.config.validation - INFO -   Model Inactivity Timeout: 55s
2026-01-04 11:32:19 - app.config.validation - INFO - Subscription Tiers:
2026-01-04 11:32:19 - app.config.validation - INFO -   free: 20 daily, 3 models/comparison, overage: False
2026-01-04 11:32:19 - app.config.validation - INFO -   starter: 50 daily, 6 models/comparison, overage: True
2026-01-04 11:32:19 - app.config.validation - INFO -   starter_plus: 100 daily, 6 models/comparison, overage: True
2026-01-04 11:32:19 - app.config.validation - INFO -   pro: 200 daily, 9 models/comparison, overage: True
2026-01-04 11:32:19 - app.config.validation - INFO -   pro_plus: 400 daily, 12 models/comparison, overage: True
2026-01-04 11:32:19 - app.config.validation - INFO - ================================================================================
2026-01-04 11:32:19 - app.main - INFO - Initializing database tables (development mode)...
2026-01-04 11:32:19 - app.main - INFO - Database initialization complete
2026-01-04 11:32:19 - app.main - INFO - Preloading model token limits...
2026-01-04 11:32:19 - app.model_runner - INFO - Preloading model token limits from OpenRouter...
2026-01-04 11:32:19 - httpx - INFO - HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
2026-01-04 11:32:19 - app.model_runner - INFO - Preloaded token limits for 68 configured models
2026-01-04 11:32:19 - app.model_runner - INFO - Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
2026-01-04 11:32:19 - app.main - INFO - Initializing search rate limiter...
2026-01-04 11:32:19 - app.main - INFO - Search rate limiter initialized successfully
2026-01-04 11:32:19 - app.main - INFO - Application startup complete
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:81 Validating configuration...
INFO     app.config.validation:validation.py:184 Configuration validation passed successfully
INFO     app.config.validation:validation.py:211 ================================================================================
INFO     app.config.validation:validation.py:212 Application Configuration
INFO     app.config.validation:validation.py:213 ================================================================================
INFO     app.config.validation:validation.py:216 Environment: development
INFO     app.config.validation:validation.py:217 Frontend URL: http://localhost:5173
INFO     app.config.validation:validation.py:235 Database URL: sqlite:///./data/compareintel.db
INFO     app.config.validation:validation.py:238 Secret Key: test...hars
INFO     app.config.validation:validation.py:241 OpenRouter API Key: test...only
INFO     app.config.validation:validation.py:252 Email Configuration: (not configured)
INFO     app.config.validation:validation.py:255 Performance Settings:
INFO     app.config.validation:validation.py:256   Individual Model Timeout: 120s
INFO     app.config.validation:validation.py:257   Model Inactivity Timeout: 55s
INFO     app.config.validation:validation.py:260 Subscription Tiers:
INFO     app.config.validation:validation.py:262   free: 20 daily, 3 models/comparison, overage: False
INFO     app.config.validation:validation.py:262   starter: 50 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   starter_plus: 100 daily, 6 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro: 200 daily, 9 models/comparison, overage: True
INFO     app.config.validation:validation.py:262   pro_plus: 400 daily, 12 models/comparison, overage: True
INFO     app.config.validation:validation.py:270 ================================================================================
INFO     app.main:main.py:90 Initializing database tables (development mode)...
INFO     app.main:main.py:92 Database initialization complete
INFO     app.main:main.py:97 Preloading model token limits...
INFO     app.model_runner:model_runner.py:934 Preloading model token limits from OpenRouter...
INFO     httpx:_client.py:1025 HTTP Request: GET https://openrouter.ai/api/v1/models "HTTP/1.1 200 OK"
INFO     app.model_runner:model_runner.py:950 Preloaded token limits for 68 configured models
INFO     app.model_runner:model_runner.py:952 Skipped 1 model(s) not available from OpenRouter: x-ai/grok-5
INFO     app.main:main.py:101 Initializing search rate limiter...
INFO     app.main:main.py:104 Search rate limiter initialized successfully
INFO     app.main:main.py:106 Application startup complete
_________ TestAnonymousCreditBoundaries.test_anonymous_one_below_limit _________
tests/unit/test_rate_limiting_edge_cases.py:214: in test_anonymous_one_below_limit
    assert is_allowed is True
E   assert False is True
----------------------------- Captured stdout call -----------------------------
[DEBUG] deduct_anonymous_credits - ip:192.168.1.2: deducted 49 credits (from 49.0000), new count: 50 (capped at 50)
_____________ TestBraveSearchProvider.test_provider_initialization _____________
tests/unit/test_search_providers.py:48: in test_provider_initialization
    assert provider.base_url == "https://api.search.brave.com/res/v1/web/search"
           ^^^^^^^^^^^^^^^^^
E   AttributeError: 'BraveSearchProvider' object has no attribute 'base_url'
_________________ TestBraveSearchProvider.test_search_success __________________
tests/unit/test_search_providers.py:93: in test_search_success
    results = await provider.search("test query", max_results=5)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/brave.py:100: in search
    return await execute_with_retry(_execute_search, retry_config, query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/retry.py:66: in execute_with_retry
    result = await coro_func()
             ^^^^^^^^^^^^^^^^^
app/search/brave.py:85: in _execute_search
    web_results = data.get("web", {}).get("results", [])
                  ^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'get'
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:41 - app.search.retry - ERROR - Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
------------------------------ Captured log call -------------------------------
ERROR    app.search.retry:retry.py:120 Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
_________ TestBraveSearchProvider.test_search_with_custom_max_results __________
tests/unit/test_search_providers.py:121: in test_search_with_custom_max_results
    results = await provider.search("test query", max_results=3)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/brave.py:100: in search
    return await execute_with_retry(_execute_search, retry_config, query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/retry.py:66: in execute_with_retry
    result = await coro_func()
             ^^^^^^^^^^^^^^^^^
app/search/brave.py:85: in _execute_search
    web_results = data.get("web", {}).get("results", [])
                  ^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'get'
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:41 - app.search.retry - ERROR - Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
------------------------------ Captured log call -------------------------------
ERROR    app.search.retry:retry.py:120 Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
______________ TestBraveSearchProvider.test_search_empty_results _______________
tests/unit/test_search_providers.py:167: in test_search_empty_results
    results = await provider.search("test query")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/brave.py:100: in search
    return await execute_with_retry(_execute_search, retry_config, query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/retry.py:66: in execute_with_retry
    result = await coro_func()
             ^^^^^^^^^^^^^^^^^
app/search/brave.py:85: in _execute_search
    web_results = data.get("web", {}).get("results", [])
                  ^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'get'
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:41 - app.search.retry - ERROR - Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
------------------------------ Captured log call -------------------------------
ERROR    app.search.retry:retry.py:120 Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
______________ TestBraveSearchProvider.test_search_missing_fields ______________
tests/unit/test_search_providers.py:193: in test_search_missing_fields
    results = await provider.search("test query")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/brave.py:100: in search
    return await execute_with_retry(_execute_search, retry_config, query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/search/retry.py:66: in execute_with_retry
    result = await coro_func()
             ^^^^^^^^^^^^^^^^^
app/search/brave.py:85: in _execute_search
    web_results = data.get("web", {}).get("results", [])
                  ^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'get'
----------------------------- Captured stderr call -----------------------------
2026-01-04 11:32:41 - app.search.retry - ERROR - Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
------------------------------ Captured log call -------------------------------
ERROR    app.search.retry:retry.py:120 Unexpected error in Brave Search (attempt 1/3): 'coroutine' object has no attribute 'get'
________________ TestConstants.test_extended_tier_limits_exist _________________
tests/unit/test_utils.py:155: in test_extended_tier_limits_exist
    from app.config import EXTENDED_TIER_LIMITS
E   ImportError: cannot import name 'EXTENDED_TIER_LIMITS' from 'app.config' (/home/dan_wsl/jaydeelew/CompareIntel/backend/app/config/__init__.py)
=============================== warnings summary ===============================
venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/dan_wsl/jaydeelew/CompareIntel/backend/venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

tests/unit/test_auth.py::TestUserRegistration::test_register_invalid_email
tests/unit/test_auth.py::TestUserRegistration::test_register_weak_password
tests/unit/test_auth.py::TestTokenRefresh::test_refresh_token_unauthorized
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_login_with_empty_email
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_empty_fields
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_very_long_email
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_sql_injection_attempt
tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_register_with_xss_attempt
  /home/dan_wsl/jaydeelew/CompareIntel/backend/venv/lib/python3.12/site-packages/_pytest/python.py:166: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    result = testfunction(**testargs)

tests/unit/test_auth.py::TestUserLogin::test_login_nonexistent_user
tests/unit/test_auth.py::TestUserLogin::test_login_unverified_user
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/routers/auth.py:71: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

tests/unit/test_auth.py::TestUserLogin::test_login_nonexistent_user
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/routers/auth.py:92: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    failed_login_attempts[client_ip].append(datetime.utcnow())

tests/unit/test_auth.py::TestUserLogin::test_login_unverified_user
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_without_bearer_prefix
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_with_invalid_user_id
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_without_sub_claim
tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_with_non_numeric_sub
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/auth.py:86: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)

tests/unit/test_auth.py::TestUserLogin::test_login_unverified_user
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/auth.py:104: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expire = datetime.utcnow() + timedelta(days=REFRESH_TOKEN_EXPIRE_DAYS)

tests/unit/test_auth.py::TestEmailVerification::test_verify_email_success
  /home/dan_wsl/jaydeelew/CompareIntel/backend/tests/unit/test_auth.py:196: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    verification_token_expires=datetime.utcnow() + timedelta(hours=24),

tests/unit/test_auth.py::TestEmailVerification::test_verify_email_success
tests/unit/test_auth.py::TestEmailVerification::test_verify_email_invalid_token
tests/unit/test_auth.py::TestEmailVerification::test_verify_email_expired_token
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/routers/auth.py:404: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    .filter(User.verification_token == verification.token, User.verification_token_expires > datetime.utcnow())

tests/unit/test_auth.py::TestEmailVerification::test_verify_email_expired_token
  /home/dan_wsl/jaydeelew/CompareIntel/backend/tests/unit/test_auth.py:237: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    verification_token_expires=datetime.utcnow() - timedelta(hours=1),  # Expired

tests/unit/test_auth.py::TestPasswordReset::test_reset_password_success
  /home/dan_wsl/jaydeelew/CompareIntel/backend/tests/unit/test_auth.py:319: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    reset_token_expires=datetime.utcnow() + timedelta(hours=1),

tests/unit/test_auth.py::TestPasswordReset::test_reset_password_success
tests/unit/test_auth.py::TestPasswordReset::test_reset_password_invalid_token
tests/unit/test_auth.py::TestPasswordReset::test_reset_password_expired_token
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/routers/auth.py:522: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    user = db.query(User).filter(User.reset_token == reset.token, User.reset_token_expires > datetime.utcnow()).first()

tests/unit/test_auth.py::TestPasswordReset::test_reset_password_expired_token
  /home/dan_wsl/jaydeelew/CompareIntel/backend/tests/unit/test_auth.py:364: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    reset_token_expires=datetime.utcnow() - timedelta(hours=1),  # Expired

tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_success
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_with_custom_max_results
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_api_error
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_empty_results
tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_missing_fields
  /home/dan_wsl/jaydeelew/CompareIntel/backend/app/search/brave.py:79: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    response.raise_for_status()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_api_error
  /home/dan_wsl/jaydeelew/CompareIntel/backend/tests/unit/test_search_providers.py:136: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    with pytest.raises(Exception):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.3-final-0 ________________

Name                                     Stmts   Miss  Cover   Missing
----------------------------------------------------------------------
app/auth.py                                 71     11    85%   45-47, 66-67, 84, 122, 129, 135-141
app/cache.py                                88     63    28%   33-43, 47-48, 52-53, 57, 61-68, 88-111, 130-140, 145-146, 159-166, 175-176, 192-202, 207-209
app/config/__init__.py                      14      5    64%   71-78
app/config/constants.py                     12      0   100%
app/config/helpers.py                       12      7    42%   27, 41-56, 69
app/config/settings.py                      42      2    95%   21, 62
app/config/validation.py                   108     48    56%   46, 51, 57, 66, 68, 86-95, 102, 112, 123, 128, 130, 136, 138, 145, 147, 157, 166, 168, 177-178, 181-182, 199, 224-233, 245-250
app/credit_manager.py                      156    131    16%   42-48, 64-69, 97-134, 149-186, 199-205, 218-225, 243-263, 279-315, 329-355, 381-395, 411-449
app/data_retention.py                      104    104     0%   9-253
app/database.py                             63     33    48%   34, 48, 71, 108-142, 150-152, 161-163
app/dependencies.py                         79     43    46%   42-72, 126-129, 142-144, 157-170, 186-197, 209
app/email_service.py                       126    126     0%   8-743
app/main.py                                135     57    58%   94, 107-115, 131, 174-206, 227-241, 264, 269-292, 297-302
app/middleware/__init__.py                   0      0   100%
app/middleware/profiling.py                 25      3    88%   54, 58, 62
app/mock_responses.py                        9      0   100%
app/model_runner.py                       1459   1283    12%   130-142, 160-179, 797-828, 882-919, 956-958, 989-996, 1012-1039, 1068-1071, 1086, 1090-1093, 1109-1112, 1121, 1135-1139, 1153-1157, 1180-1212, 1223-1239, 1253-1276, 1295-1326, 1368, 1385, 1410-1456, 1484-1486, 1500-1504, 1533-1550, 1562-1576, 1642, 1646-1652, 1656-1660, 1671-1684, 1693-1694, 1702, 1707, 1731-1736, 1746-1756, 1763, 1770-3611, 3625-3626, 3633-3636, 3640-3659, 3662-3666, 3684-3692, 3698-3709, 3712-3723, 3755-3792, 3797-3833
app/models.py                              187      1    99%   84
app/rate_limiting.py                       192     85    56%   111-116, 135-137, 165-174, 192, 227-271, 273, 279-290, 315-316, 344, 350-359, 399-414, 453, 469, 510-513, 523, 539-540, 553-554, 567-568, 581, 591
app/routers/__init__.py                      0      0   100%
app/routers/admin.py                      1311   1200     8%   52, 70-96, 106-141, 160-256, 285-318, 335-346, 359-397, 411-478, 490-567, 580-602, 614-644, 658-696, 708-735, 758-805, 823-863, 876-931, 944-988, 1015-1067, 1091-1163, 1208-1227, 1272-1298, 1309-1322, 1332-1343, 1351-1371, 1402-1424, 1438-1456, 1469-1503, 1523-1556, 1566, 1582-1663, 1675-1680, 1697-1715, 1729-1743, 1757-2072, 2090-2673, 2687-2914, 2933-2958, 2976-3016, 3032-3060, 3078-3117
app/routers/api.py                        1027    937     9%   165-179, 190-221, 241-272, 277-284, 301-351, 362-386, 405-448, 454-466, 483-512, 538-550, 585-1967, 1976-2047, 2057-2122, 2158-2298, 2319-2358, 2374-2394, 2411-2502
app/routers/auth.py                        276    138    50%   60, 80-84, 113-114, 121-160, 178-252, 298-300, 303-305, 329-335, 350, 355-381, 385-388, 437-473, 492-510, 538, 552-554, 566-569, 580-581
app/routers/dev.py                          92     92     0%   8-266
app/schemas.py                             270     29    89%   33, 35, 37, 41, 144, 146, 148, 152, 212-214, 236-238, 290-292, 382-393
app/search/__init__.py                       5      0   100%
app/search/base.py                          19      3    84%   41, 51, 61
app/search/brave.py                         46     12    74%   34-36, 53, 87-96, 112, 116-118
app/search/distributed_rate_limiter.py     410    318    22%   32-35, 91-95, 107-122, 126-138, 146-151, 155-164, 168-181, 185-201, 248-253, 259, 268-329, 333-347, 392-393, 417, 432-435, 439-492, 496, 500-535, 542-557, 570-688, 698-808, 815-819, 823-828, 833-856
app/search/factory.py                       45      9    80%   44-48, 57-62, 95
app/search/rate_limiter.py                 167    112    33%   53-54, 63-79, 83-93, 97-103, 107-108, 135-154, 158, 162-169, 184-237, 241-243, 252-273, 278-295, 344-360, 380-396, 402-405
app/search/retry.py                         68     40    41%   67, 70-104, 107-116, 124-126, 140-165
app/types.py                                94      0   100%
app/utils/cookies.py                        21      3    86%   78-90
----------------------------------------------------------------------
TOTAL                                     6733   4895    27%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/unit/test_auth.py::TestUserRegistration::test_register_new_user - assert 400 == 201
 +  where 400 = <Response [400 Bad Request]>.status_code
 +  and   201 = status.HTTP_201_CREATED
FAILED tests/unit/test_auth.py::TestTokenRefresh::test_refresh_token_unauthorized - assert 401 == 422
 +  where 401 = <Response [401 Unauthorized]>.status_code
 +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY
FAILED tests/unit/test_auth.py::TestEmailVerification::test_resend_verification_email - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth.py::TestUserInfo::test_delete_account - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth.py::TestUserInfo::test_delete_account_unverified - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth.py::TestLoginEdgeCases::test_login_inactive_user - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth.py::TestLoginEdgeCases::test_refresh_token_with_inactive_user - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_expired_access_token - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_expired_refresh_token - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_token_after_user_deletion - TypeError: 'daily_usage_count' is an invalid keyword argument for User
FAILED tests/unit/test_rate_limiting_edge_cases.py::TestAnonymousCreditBoundaries::test_anonymous_one_below_limit - assert False is True
FAILED tests/unit/test_search_providers.py::TestBraveSearchProvider::test_provider_initialization - AttributeError: 'BraveSearchProvider' object has no attribute 'base_url'
FAILED tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_success - AttributeError: 'coroutine' object has no attribute 'get'
FAILED tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_with_custom_max_results - AttributeError: 'coroutine' object has no attribute 'get'
FAILED tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_empty_results - AttributeError: 'coroutine' object has no attribute 'get'
FAILED tests/unit/test_search_providers.py::TestBraveSearchProvider::test_search_missing_fields - AttributeError: 'coroutine' object has no attribute 'get'
FAILED tests/unit/test_utils.py::TestConstants::test_extended_tier_limits_exist - ImportError: cannot import name 'EXTENDED_TIER_LIMITS' from 'app.config' (/home/dan_wsl/jaydeelew/CompareIntel/backend/app/config/__init__.py)
ERROR tests/unit/test_auth.py::TestUserRegistration::test_register_duplicate_email - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestUserLogin::test_login_success - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestUserLogin::test_login_wrong_password - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestTokenRefresh::test_refresh_token_success - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestEmailVerification::test_resend_verification_already_verified - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestPasswordReset::test_forgot_password_success - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestUserInfo::test_get_current_user_info - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestUserInfo::test_logout - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth.py::TestLoginEdgeCases::test_login_case_sensitive_email - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_access_token_as_refresh_token - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth_edge_cases.py::TestTokenEdgeCases::test_refresh_token_as_access_token - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_auth_edge_cases.py::TestAuthEdgeCases::test_login_with_empty_password - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_free_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_premium_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_credits_exceeded - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestUserCreditLimiting::test_deduct_user_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestCreditLimitEdgeCases::test_credits_with_invalid_tier - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestCreditLimitEdgeCases::test_concurrent_credit_checks - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_free_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_plus_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_plus_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_free_tier_exceeds_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_starter_tier_exceeds_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestAllTierCredits::test_pro_tier_exceeds_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting.py::TestUsageStats::test_user_usage_stats - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_at_exact_limit - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_one_below_limit - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_one_above_limit - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUserCreditBoundaries::test_credits_zero_usage - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestCreditReset::test_reset_on_new_day - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestCreditReset::test_no_reset_same_day - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_by_one - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_by_multiple - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_zero - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDeductCredits::test_deduct_more_than_allocated - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUsageStats::test_usage_stats_at_limit - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestUsageStats::test_usage_stats_zero_usage - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestConcurrentAccess::test_concurrent_deduction - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_free_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_starter_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_pro_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
ERROR tests/unit/test_rate_limiting_edge_cases.py::TestDifferentSubscriptionTiers::test_pro_plus_tier_credits - TypeError: 'daily_usage_count' is an invalid keyword argument for User
============ 17 failed, 86 passed, 34 warnings, 44 errors in 44.24s ============
